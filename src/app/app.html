<!-- LCARS Star Trek Dashboard -->
<div class="lcars-container">
  <!-- Header Section -->
  <div class="lcars-header">
    <div class="lcars-elbow top-left"></div>
    <div class="lcars-bar header-bar">
      <span class="lcars-text">USS ENTERPRISE NCC-1701-D</span>
    </div>
    <div class="lcars-elbow top-right"></div>
  </div>

  <!-- Main Content Area -->
  <div class="lcars-main">
    <!-- Left Panel -->
    <div class="lcars-left-panel">
      <div class="lcars-button" [class.active]="activeSection() === 'SPACE'" (click)="setActiveSection('SPACE')">SPACE</div>
      <div class="lcars-button" [class.active]="activeSection() === 'ENVIRONMENT'" (click)="setActiveSection('ENVIRONMENT')">ENVIRONMENT</div>
      <div class="lcars-button" [class.active]="activeSection() === 'NAVIGATION'" (click)="setActiveSection('NAVIGATION')">NAVIGATION</div>
      <div class="lcars-button" [class.active]="activeSection() === 'COMMUNICATIONS'" (click)="setActiveSection('COMMUNICATIONS')">COMMUNICATIONS</div>
      <div class="lcars-button" [class.active]="activeSection() === 'ECONOMICS'" (click)="setActiveSection('ECONOMICS')">ECONOMICS</div>
      <div class="lcars-button" [class.active]="activeSection() === 'ENGINEERING'" (click)="setActiveSection('ENGINEERING')">ENGINEERING</div>
      <div class="lcars-button" [class.active]="activeSection() === 'MEDICAL'" (click)="setActiveSection('MEDICAL')">MEDICAL</div>
      <div class="lcars-button" [class.active]="activeSection() === 'TACTICAL'" (click)="setActiveSection('TACTICAL')">TACTICAL</div>
      <div class="lcars-spacer"></div>
      <div class="lcars-text-display">
        STARDATE<br>
        <span class="lcars-data">{{ currentStardate() }}</span>
      </div>
      @if (issPosition()) {
        <div class="lcars-text-display">
          ISS POSITION<br>
          <span class="lcars-data">{{ formatCoordinate(issPosition()!.latitude, true) }}</span><br>
          <span class="lcars-data">{{ formatCoordinate(issPosition()!.longitude, false) }}</span>
        </div>
      }
    </div>

    <!-- Center Content -->
    <div class="lcars-center">
      <div class="lcars-screen">
        <div class="lcars-screen-header">
          <span class="lcars-text">{{ activeSection() }} OPERATIONS STATUS</span>
        </div>
        
        <!-- Space Section -->
        @if (activeSection() === 'SPACE') {
          <div class="space-section">
            <div class="data-grid">
              <div class="data-panel">
                <h3>ISS TRACKING</h3>
                @if (issPosition()) {
                  <div class="data-line">
                    <span>Altitude:</span>
                    <span class="data-value">{{ issPosition()!.altitude }} km</span>
                  </div>
                  <div class="data-line">
                    <span>Coordinates:</span>
                    <span class="data-value">{{ formatCoordinate(issPosition()!.latitude, true) }}, {{ formatCoordinate(issPosition()!.longitude, false) }}</span>
                  </div>
                } @else {
                  <div class="data-line">
                    <span class="data-value">Acquiring signal...</span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>ASTRONAUTS IN SPACE</h3>
                @for (astronaut of astronauts(); track astronaut.name) {
                  <div class="data-line">
                    <span>{{ astronaut.name }}:</span>
                    <span class="data-value">{{ astronaut.craft }}</span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>UPCOMING LAUNCHES</h3>
                @for (launch of upcomingLaunches().slice(0, 3); track launch.flight_number) {
                  <div class="data-line">
                    <span>{{ launch.name }}:</span>
                    <span class="data-value">{{ launch.date_utc | date:'MMM dd' }}</span>
                  </div>
                }
              </div>
            </div>
          </div>
        }
        
        <!-- Environment Section -->
        @if (activeSection() === 'ENVIRONMENT') {
          <div class="environment-section">
            <div class="data-grid">
              <div class="data-panel">
                <h3>WEATHER CONDITIONS</h3>
                @if (weather()) {
                  <div class="data-line">
                    <span>Temperature:</span>
                    <span class="data-value">{{ weather()!.temperature }}°C</span>
                  </div>
                  <div class="data-line">
                    <span>Humidity:</span>
                    <span class="data-value">{{ weather()!.humidity }}%</span>
                  </div>
                  <div class="data-line">
                    <span>Pressure:</span>
                    <span class="data-value">{{ weather()!.pressure }} hPa</span>
                  </div>
                  <div class="data-line">
                    <span>Conditions:</span>
                    <span class="data-value">{{ weather()!.description }}</span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>AIR QUALITY</h3>
                @if (airQuality()) {
                  <div class="data-line">
                    <span>AQI:</span>
                    <span class="data-value" [class.warning]="airQuality()!.aqi > 100">{{ airQuality()!.aqi }}</span>
                  </div>
                  <div class="data-line">
                    <span>Status:</span>
                    <span class="data-value">{{ airQuality()!.status }}</span>
                  </div>
                  <div class="data-line">
                    <span>PM2.5:</span>
                    <span class="data-value">{{ airQuality()!.pm25 }} μg/m³</span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>SEISMIC ACTIVITY</h3>
                @for (earthquake of recentEarthquakes().slice(0, 3); track earthquake.location) {
                  <div class="data-line">
                    <span>M{{ earthquake.magnitude }}:</span>
                    <span class="data-value">{{ earthquake.location }}</span>
                  </div>
                }
              </div>
            </div>
          </div>
        }
        
        <!-- Navigation Section -->
        @if (activeSection() === 'NAVIGATION') {
          <div class="navigation-section">
            <div class="data-grid">
              <div class="data-panel">
                <h3>CURRENT LOCATION</h3>
                @if (userLocation()) {
                  <div class="data-line">
                    <span>Location:</span>
                    <span class="data-value">{{ userLocation()!.city }}, {{ userLocation()!.region }}</span>
                  </div>
                  <div class="data-line">
                    <span>Country:</span>
                    <span class="data-value">{{ userLocation()!.country }}</span>
                  </div>
                  <div class="data-line">
                    <span>Coordinates:</span>
                    <span class="data-value">{{ formatCoordinate(userLocation()!.latitude, true) }}, {{ formatCoordinate(userLocation()!.longitude, false) }}</span>
                  </div>
                  <div class="data-line">
                    <span>IP Address:</span>
                    <span class="data-value">{{ userLocation()!.ip }}</span>
                  </div>
                  <div class="data-line">
                    <span>ISP:</span>
                    <span class="data-value">{{ userLocation()!.isp }}</span>
                  </div>
                  <div class="data-line">
                    <span>Source:</span>
                    <span class="data-value">{{ userLocation()!.source.toUpperCase() }}</span>
                  </div>
                } @else {
                  <div class="data-line">
                    <span>Status:</span>
                    <span class="data-value">Acquiring location... (Check browser console for details)</span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>NEARBY AIRCRAFT</h3>
                @for (flight of nearbyFlights().slice(0, 5); track flight.callsign) {
                  <div class="data-line">
                    <span>{{ flight.callsign }}:</span>
                    <span class="data-value">{{ flight.altitude }}m, {{ flight.velocity }}m/s</span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>SHIP STATUS</h3>
                <div class="data-line">
                  <span>Hull Integrity:</span>
                  <span class="data-value">{{ hullIntegrity() }}%</span>
                </div>
                <div class="data-line">
                  <span>Warp Speed:</span>
                  <span class="data-value">{{ warpSpeed() }}</span>
                </div>
                <div class="data-line">
                  <span>Power Levels:</span>
                  <span class="data-value">{{ powerLevels() }}%</span>
                </div>
              </div>
            </div>
          </div>
        }
        
        <!-- Communications Section -->
        @if (activeSection() === 'COMMUNICATIONS') {
          <div class="communications-section">
            <div class="data-panel">
              <h3>LATEST TRANSMISSIONS</h3>
              @for (news of latestNews().slice(0, 4); track news.title) {
                <div class="news-item">
                  <div class="news-title">{{ news.title }}</div>
                  <div class="news-meta">{{ news.source }} - {{ formatTimeAgo(news.publishedAt) }}</div>
                  <div class="news-description">{{ news.description }}</div>
                </div>
              }
            </div>
          </div>
        }
        
        <!-- Economics Section -->
        @if (activeSection() === 'ECONOMICS') {
          <div class="economics-section">
            <div class="data-grid">
              <div class="data-panel">
                <h3>STOCK INDICES</h3>
                @for (stock of stockIndices().slice(0, 8); track stock.symbol) {
                  <div class="data-line">
                    <span>{{ stock.name }}:</span>
                    <span class="data-value">{{ stock.value | number:'1.0-2' }}</span>
                    <span class="data-change" [class.positive]="stock.change > 0" [class.negative]="stock.change < 0">
                      {{ stock.change > 0 ? '+' : '' }}{{ stock.change | number:'1.0-2' }} ({{ stock.changePercent > 0 ? '+' : '' }}{{ stock.changePercent | number:'1.1-1' }}%)
                    </span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>ECONOMIC INDICATORS</h3>
                @for (indicator of economicIndicators(); track indicator.name) {
                  <div class="data-line">
                    <span>{{ indicator.name }}:</span>
                    <span class="data-value">{{ indicator.value }} {{ indicator.unit }}</span>
                    <span class="data-change" [class.positive]="indicator.change > 0" [class.negative]="indicator.change < 0">
                      {{ indicator.change > 0 ? '+' : '' }}{{ indicator.change }}
                    </span>
                  </div>
                }
              </div>
              
              <div class="data-panel">
                <h3>CURRENCY VALUES</h3>
                @for (crypto of cryptoPrices(); track crypto.symbol) {
                  <div class="data-line">
                    <span>{{ crypto.symbol }}:</span>
                    <span class="data-value">{{ crypto.price | number:'1.0-2' }}</span>
                    <span class="data-change" [class.positive]="crypto.change24h > 0" [class.negative]="crypto.change24h < 0">
                      {{ crypto.change24h > 0 ? '+' : '' }}{{ crypto.change24h | number:'1.1-1' }}%
                    </span>
                  </div>
                }
              </div>
            </div>
          </div>
        }
        
        <!-- Engineering Section (Default) -->
        @if (activeSection() === 'ENGINEERING' || activeSection() === 'MEDICAL') {
          <div class="engineering-section">
            <div class="status-grid">
              <div class="status-item">
                <div class="status-label">WARP CORE</div>
                <div class="status-indicator active"></div>
                <div class="status-value">OPTIMAL</div>
              </div>
              
              <div class="status-item">
                <div class="status-label">SHIELDS</div>
                <div class="status-indicator active"></div>
                <div class="status-value">100%</div>
              </div>
              
              <div class="status-item">
                <div class="status-label">LIFE SUPPORT</div>
                <div class="status-indicator active"></div>
                <div class="status-value">NOMINAL</div>
              </div>
              
              <div class="status-item">
                <div class="status-label">IMPULSE ENGINES</div>
                <div class="status-indicator active"></div>
                <div class="status-value">STANDBY</div>
              </div>
            </div>

            <div class="lcars-data-panel">
              <div class="data-column">
                <h3>SENSOR READINGS</h3>
                <div class="data-line">
                  <span>Temperature:</span>
                  <span class="data-value">{{ shipTemperature() }}°C</span>
                </div>
                <div class="data-line">
                  <span>Hull Integrity:</span>
                  <span class="data-value">{{ hullIntegrity() }}%</span>
                </div>
                <div class="data-line">
                  <span>Power Levels:</span>
                  <span class="data-value">{{ powerLevels() }}%</span>
                </div>
              </div>
              
              <div class="data-column">
                <h3>CREW STATUS</h3>
                <div class="data-line">
                  <span>Personnel:</span>
                  <span class="data-value">{{ crewCount() }}</span>
                </div>
                <div class="data-line">
                  <span>On Duty:</span>
                  <span class="data-value">{{ onDuty() }}</span>
                </div>
                <div class="data-line">
                  <span>Medical:</span>
                  <span class="data-value">{{ medicalStatus() }}</span>
                </div>
              </div>
            </div>
          </div>
        }
        
        <!-- Tactical Section -->
        @if (activeSection() === 'TACTICAL') {
          <div class="tactical-section">
            <div class="tactical-grid">
              <!-- Weapons Systems -->
              <div class="tactical-panel weapons-panel">
                <h3>WEAPONS SYSTEMS</h3>
                <div class="weapon-status">
                  <div class="weapon-item">
                    <div class="weapon-label">PHASERS</div>
                    <div class="weapon-indicator" [class.armed]="phaserStatus() === 'ARMED'"></div>
                    <div class="weapon-value">{{ phaserStatus() }}</div>
                    <div class="weapon-controls">
                      <button class="tactical-button" 
                              [class.armed]="phaserStatus() === 'ARMED'"
                              (click)="togglePhasers()">{{ phaserStatus() === 'ARMED' ? 'DISARM' : 'ARM' }}</button>
                      <button class="tactical-button fire-button" 
                              [disabled]="phaserStatus() !== 'ARMED'"
                              [class.ready]="phaserStatus() === 'ARMED'"
                              (click)="firePhasers()">FIRE</button>
                    </div>
                  </div>
                  
                  <div class="weapon-item">
                    <div class="weapon-label">PHOTON TORPEDOES</div>
                    <div class="weapon-indicator" [class.armed]="torpedoStatus() === 'ARMED'"></div>
                    <div class="weapon-value">{{ torpedoCount() }} LOADED</div>
                    <div class="weapon-controls">
                      <button class="tactical-button"
                              [class.armed]="torpedoStatus() === 'ARMED'"
                              (click)="toggleTorpedoes()">{{ torpedoStatus() === 'ARMED' ? 'DISARM' : 'ARM' }}</button>
                      <button class="tactical-button fire-button" 
                              [disabled]="torpedoStatus() !== 'ARMED' || torpedoCount() <= 0"
                              [class.ready]="torpedoStatus() === 'ARMED' && torpedoCount() > 0"
                              (click)="fireTorpedoes()">FIRE</button>
                    </div>
                  </div>
                  
                  <div class="weapon-item">
                    <div class="weapon-label">SHIELDS</div>
                    <div class="weapon-indicator" [class.active]="shieldStatus() === 'UP'"></div>
                    <div class="weapon-value">{{ shieldPower() }}%</div>
                    <button class="tactical-button"
                            [class.active]="shieldStatus() === 'UP'"
                            (click)="toggleShields()">{{ shieldStatus() === 'UP' ? 'LOWER' : 'RAISE' }}</button>
                  </div>
                </div>
              </div>
              
              <!-- Scanner Systems -->
              <div class="tactical-panel scanner-panel">
                <h3>SENSOR ARRAY</h3>
                <div class="scanner-grid">
                  <div class="scanner-item">
                    <div class="scanner-label">LONG RANGE SENSORS</div>
                    <div class="scanner-indicator active"></div>
                    <div class="scanner-value">{{ longRangeScanRange() }} LY</div>
                  </div>
                  
                  <div class="scanner-item">
                    <div class="scanner-label">SHORT RANGE SENSORS</div>
                    <div class="scanner-indicator active"></div>
                    <div class="scanner-value">{{ shortRangeScanRange() }} KM</div>
                  </div>
                  
                  <div class="scanner-item">
                    <div class="scanner-label">DEFLECTOR ARRAY</div>
                    <div class="scanner-indicator" [class.active]="deflectorStatus() === 'ACTIVE'"></div>
                    <div class="scanner-value">{{ deflectorStatus() }}</div>
                  </div>
                  
                  <div class="scanner-item">
                    <div class="scanner-label">THREAT ASSESSMENT</div>
                    <div class="scanner-indicator" [class.active]="threatLevel() !== 'NONE'"></div>
                    <div class="scanner-value">{{ threatLevel() }}</div>
                  </div>
                </div>
              </div>
              
              <!-- Red Alert Controls -->
              <div class="tactical-panel alert-panel">
                <h3>ALERT STATUS</h3>
                <div class="alert-controls">
                  <div class="current-alert" [class.red]="alertStatus() === 'RED'" 
                                           [class.yellow]="alertStatus() === 'YELLOW'"
                                           [class.green]="alertStatus() === 'GREEN'">
                    {{ alertStatus() }} ALERT
                  </div>
                  
                  <div class="alert-buttons">
                    <button class="red-alert-button" 
                            [class.active]="alertStatus() === 'RED'"
                            (click)="setRedAlert()">RED ALERT</button>
                    <button class="yellow-alert-button"
                            [class.active]="alertStatus() === 'YELLOW'" 
                            (click)="setYellowAlert()">YELLOW ALERT</button>
                    <button class="green-alert-button"
                            [class.active]="alertStatus() === 'GREEN'"
                            (click)="setGreenAlert()">ALL CLEAR</button>
                  </div>
                </div>
              </div>
              
              <!-- Tactical Display -->
              <div class="tactical-panel display-panel">
                <h3>TACTICAL DISPLAY</h3>
                <div class="tactical-display">
                  <div class="display-grid">
                    <div class="target-display">
                      <div class="crosshairs"></div>
                      <div class="range-rings"></div>
                      <div class="target-marker" [style.display]="hasTarget() ? 'block' : 'none'"></div>
                    </div>
                    <div class="tactical-readout">
                      <div class="readout-line">
                        <span>RANGE:</span>
                        <span class="readout-value">{{ targetRange() }}</span>
                      </div>
                      <div class="readout-line">
                        <span>BEARING:</span>
                        <span class="readout-value">{{ targetBearing() }}</span>
                      </div>
                      <div class="readout-line">
                        <span>VELOCITY:</span>
                        <span class="readout-value">{{ targetVelocity() }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Right Panel -->
    <div class="lcars-right-panel">
      <div class="lcars-slider">
        <div class="slider-label">WARP SPEED</div>
        <div class="slider-track">
          <input type="range" 
                 min="0" 
                 max="10" 
                 [value]="warpSpeed()" 
                 (input)="onWarpSpeedChange($event)"
                 class="warp-slider-input"
                 title="Warp Speed Control"
                 aria-label="Warp Speed Control">
          <div class="slider-thumb" [style.left.%]="warpSpeed() * 10"></div>
        </div>
        <div class="slider-value">{{ warpSpeed() }}</div>
      </div>
      
      <div class="lcars-button audio-toggle" 
           [class.disabled]="!isAudioEnabled()" 
           (click)="onAudioToggle()"
           title="Toggle Audio">
        {{ isAudioEnabled() ? 'AUDIO ON' : 'AUDIO OFF' }}
      </div>
      
      <div class="lcars-alert-panel">
        <div class="alert-header">ALERTS</div>
        <div class="alert-item" *ngFor="let alert of alerts" [ngClass]="alert.priority">
          {{ alert.message }}
        </div>
      </div>
      
      <div class="lcars-time-display">
        <div class="time-label">CURRENT TIME</div>
        <div class="time-value">{{ currentTime() | date:'HH:mm:ss' }}</div>
        <div class="date-value">{{ currentTime() | date:'yyyy.MM.dd' }}</div>
      </div>
    </div>
  </div>

  <!-- Footer Section -->
  <div class="lcars-footer">
    <div class="lcars-elbow bottom-left"></div>
    <div class="lcars-bar footer-bar">
      <span class="lcars-text">COMPUTER ACCESS</span>
      <span class="lcars-separator">|</span>
      <span class="lcars-text">LEVEL 10</span>
      <span class="lcars-separator">|</span>
      <span class="lcars-text">AUTHORIZATION REQUIRED</span>
    </div>
    <div class="lcars-elbow bottom-right"></div>
  </div>
</div>

<router-outlet></router-outlet>
